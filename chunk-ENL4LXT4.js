import{Ba as b,Ca as U,Da as H,Ea as l,Fa as c,G as M,Ga as p,H as $,Ia as L,Ja as P,K as f,Ka as u,La as A,Ma as v,P as r,R,S as h,Va as y,Z as T,a as d,b as m,da as O,e as C,ea as B,eb as G,j as x,k as I,l as D,ma as N,p as E,pa as a,q as F,r as q,v as k,va as w}from"./chunk-H4WXIKBX.js";var J=(s,e)=>e.name;function K(s,e){if(s&1&&(l(0,"div",1),p(1,"input",2),l(2,"div",3),p(3,"img",4),u(4),c(),l(5,"div",5)(6,"p"),u(7,"Collapse Content"),c()()()),s&2){let o=e.$implicit,t=L();a(),P("name",o.name),a(2),b("src",t.getImageSourceForSpell(o.school,o.name),N),a(),A(" ",o.name," ")}}var V=(()=>{let e=class e{constructor(){this.spells=B.required(),this.schools=[{initial:"A",name:"Abjuration"},{initial:"C",name:"Conjuration"},{initial:"D",name:"Divination"},{initial:"E",name:"Enchantment"},{initial:"V",name:"Evocation"},{initial:"I",name:"Illusion"},{initial:"N",name:"Necromancy"},{initial:"T",name:"Transmutation"}]}getImageSourceForSpell(t,n){return`../../assets/spells/Spell_${this.schools.find(S=>S.initial===t)?.name}_${n.split(" ").join("")}.webp`}};e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=h({type:e,selectors:[["dnd-spells-list"]],inputs:{spells:[R.SignalBased,"spells"]},standalone:!0,features:[v],decls:3,vars:0,consts:[[1,"join","join-vertical","m-1","w-full","text-white"],[1,"collapse","join-item","collapse-arrow","border-2","border-brown-500"],["type","checkbox",3,"name"],[1,"sm:text:xl","text-md","collapse-title","font-medium"],[1,"w-12",3,"src"],[1,"collapse-content"]],template:function(n,i){n&1&&(l(0,"div",0),U(1,K,8,3,"div",1,J),c()),n&2&&(a(),H(i.spells()))},encapsulation:2});let s=e;return s})();function g(s){s||(T(g),s=r(O));let e=new C(o=>s.onDestroy(o.next.bind(o)));return o=>o.pipe($(e))}var z=(()=>{let e=class e{constructor(){this.httpClient=r(G)}requestSpellbooks(){return D([{name:"Player's Handbook",id:"PHB",jsonFileName:"spells-phb.json",spells:[],isSelected:!1,isLoaded:!1}])}requestGeneralBooksData(){return this.httpClient.get("https://5e.tools/data/generated/gendata-nav-adventure-book-index.json").pipe(k(t=>(this.handleError(t),x)),E(t=>t.adventure.concat(t.book)))}requestSpellsInBook(t){return this.httpClient.get(`https://5e.tools/data/spells/${t}`).pipe(k(n=>(this.handleError(n),x)))}handleError(t){console.log(t)}};e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=f({token:e,factory:e.\u0275fac,providedIn:"root"});let s=e;return s})();var Y=(()=>{let e=class e{constructor(){this.fiveEtoolsService=r(z),this.state=w({spellbooks:[],spells:[]}),this.spellbooks=y(()=>this.state().spellbooks),this.spells=y(()=>this.state().spellbooks.map(t=>t.spells).flat()),this.spellbooks$=F([this.fiveEtoolsService.requestSpellbooks(),this.fiveEtoolsService.requestGeneralBooksData()]).pipe(M(([t,n])=>(t.forEach(i=>i.name=n.find(S=>S.id==i.id)?.name),I(t)))),this.spells$=this.spellbooks$.pipe(q(t=>this.fiveEtoolsService.requestSpellsInBook(t.jsonFileName))),this.spellbooks$.pipe(g()).subscribe(t=>this.state.update(n=>m(d({},n),{spellbooks:[...n.spellbooks,t]}))),this.spells$.pipe(g()).subscribe(t=>this.state.update(n=>m(d({},n),{spellbooks:n.spellbooks.map(i=>i.id===t.spell[0].source?m(d({},i),{spells:t.spell}):i)})))}};e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=f({token:e,factory:e.\u0275fac,providedIn:"root"});let s=e;return s})();var Ce=(()=>{let e=class e{constructor(){this.spellsService=r(Y)}};e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=h({type:e,selectors:[["dnd-spells"]],standalone:!0,features:[v],decls:4,vars:1,consts:[[1,"text-center","text-lg","font-bold","text-brown-500"],[1,"flex","w-full","justify-center"],[1,"container","flex","justify-center",3,"spells"]],template:function(n,i){n&1&&(l(0,"p",0),u(1," Player's Handbook "),c(),l(2,"div",1),p(3,"dnd-spells-list",2),c()),n&2&&(a(3),b("spells",i.spellsService.spells()))},dependencies:[V],encapsulation:2});let s=e;return s})();export{Ce as default};
