import{Aa as O,Ba as L,Ca as B,Da as r,Ea as a,Fa as h,G as T,H as q,Ha as G,Ia as p,Ja as H,K as m,Ka as b,P as o,R as M,S as f,Ta as v,Z as $,a as u,b as d,cb as P,da as R,e as w,ea as N,j as S,k as C,l as E,oa as c,p as D,q as I,r as F,ua as k,v as j}from"./chunk-NVJGF3XY.js";var X=(s,e)=>e.name;function z(s,e){if(s&1&&(r(0,"div",1),h(1,"input",2),r(2,"div",3),p(3),a(),r(4,"div",4)(5,"p"),p(6,"Collapse Content"),a()()()),s&2){let l=e.$implicit;c(),G("name",l.name),c(2),H(" ",l.name," ")}}var U=(()=>{let e=class e{constructor(){this.spells=N.required(),this.schools=[{initial:"A",name:"Abjuration"},{initial:"C",name:"Conjuration"},{initial:"D",name:"Divination"},{initial:"E",name:"Enchantment"},{initial:"V",name:"Evocation"},{initial:"I",name:"Illusion"},{initial:"N",name:"Necromancy"},{initial:"T",name:"Transmutation"}]}getImageSourceForSpell(t,n){return`./assets/spells/Spell_${this.schools.find(g=>g.initial===t)?.name}_${n.split(" ").join("")}.webp`}};e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=f({type:e,selectors:[["dnd-spells-list"]],inputs:{spells:[M.SignalBased,"spells"]},standalone:!0,features:[b],decls:3,vars:0,consts:[[1,"join","join-vertical","m-1","w-full","text-white"],[1,"collapse","join-item","collapse-arrow","border-2","border-brown-500"],["type","checkbox",3,"name"],[1,"sm:text:xl","text-md","collapse-title","font-medium"],[1,"collapse-content"]],template:function(n,i){n&1&&(r(0,"div",0),L(1,z,7,2,"div",1,X),a()),n&2&&(c(),B(i.spells()))},encapsulation:2});let s=e;return s})();function y(s){s||($(y),s=o(R));let e=new w(l=>s.onDestroy(l.next.bind(l)));return l=>l.pipe(q(e))}var A=(()=>{let e=class e{constructor(){this.httpClient=o(P)}requestSpellbooks(){return E([{name:"Player's Handbook",id:"PHB",jsonFileName:"spells-phb.json",spells:[],isSelected:!1,isLoaded:!1},{name:"Xenethar's Guide to Everything",id:"XGE",jsonFileName:"spells-xge.json",spells:[],isSelected:!1,isLoaded:!1},{name:"Tasha's Cauldron of Everything",id:"TCE",jsonFileName:"spells-tce.json",spells:[],isSelected:!1,isLoaded:!1},{name:"Fizban's Treasury of Dragons",id:"FTD",jsonFileName:"spells-ftd.json",spells:[],isSelected:!1,isLoaded:!1}])}requestGeneralBooksData(){return this.httpClient.get("https://5e.tools/data/generated/gendata-nav-adventure-book-index.json").pipe(j(t=>(this.handleError(t),S)),D(t=>t.adventure.concat(t.book)))}requestSpellsInBook(t){return this.httpClient.get(`https://5e.tools/data/spells/${t}`).pipe(j(n=>(this.handleError(n),S)))}handleError(t){console.log(t)}};e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=m({token:e,factory:e.\u0275fac,providedIn:"root"});let s=e;return s})();var V=(()=>{let e=class e{constructor(){this.fiveEtoolsService=o(A),this.state=k({spellbooks:[],spells:[]}),this.spellbooks=v(()=>this.state().spellbooks),this.spells=v(()=>this.state().spellbooks.map(t=>t.spells).flat()),this.spellbooks$=I([this.fiveEtoolsService.requestSpellbooks(),this.fiveEtoolsService.requestGeneralBooksData()]).pipe(T(([t,n])=>(t.forEach(i=>i.name=n.find(g=>g.id==i.id)?.name),C(t)))),this.spells$=this.spellbooks$.pipe(F(t=>this.fiveEtoolsService.requestSpellsInBook(t.jsonFileName))),this.spellbooks$.pipe(y()).subscribe(t=>this.state.update(n=>d(u({},n),{spellbooks:[...n.spellbooks,t]}))),this.spells$.pipe(y()).subscribe(t=>this.state.update(n=>d(u({},n),{spellbooks:n.spellbooks.map(i=>i.id===t.spell[0].source?d(u({},i),{spells:t.spell}):i)})))}};e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=m({token:e,factory:e.\u0275fac,providedIn:"root"});let s=e;return s})();var xe=(()=>{let e=class e{constructor(){this.spellsService=o(V)}};e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=f({type:e,selectors:[["dnd-spells"]],standalone:!0,features:[b],decls:4,vars:1,consts:[[1,"text-center","text-lg","font-bold","text-brown-500"],[1,"flex","w-full","justify-center"],[1,"container","flex","justify-center",3,"spells"]],template:function(n,i){n&1&&(r(0,"p",0),p(1," Player's Handbook "),a(),r(2,"div",1),h(3,"dnd-spells-list",2),a()),n&2&&(c(3),O("spells",i.spellsService.spells()))},dependencies:[U],encapsulation:2});let s=e;return s})();export{xe as default};
