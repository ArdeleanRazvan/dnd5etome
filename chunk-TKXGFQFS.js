import{Aa as v,Ba as U,Ca as G,Da as r,Ea as c,Fa as u,G as q,H as M,Ha as H,I as N,Ia as z,Ja as p,K as h,Ka as A,La as V,Ma as y,Na as X,Oa as Y,P as l,R as b,T as R,Xa as g,Y as L,a as m,b as f,ca as O,da as B,e as E,gb as J,j as k,k as D,l as I,ma as P,p as F,pa as a,q as $,r as T,v as w,va as C}from"./chunk-E5JMGDMM.js";var K=(()=>{let e=class e{transform(t,n){return n.find(i=>i.initial===t)?.name}};e.\u0275fac=function(n){return new(n||e)},e.\u0275pipe=R({name:"school",type:e,pure:!0,standalone:!0});let s=e;return s})();var _=(s,e)=>e.name;function ee(s,e){if(s&1&&(r(0,"div",2),u(1,"input",3),r(2,"div",4)(3,"div",5)(4,"div",6),u(5,"img",7),r(6,"p",8),p(7),c()()(),r(8,"div")(9,"p",9),p(10),X(11,"school"),c()()(),r(12,"div",10)(13,"p"),p(14,"Collapse Content"),c()()()),s&2){let o=e.$implicit,t=H();a(),z("name",o.name),a(4),v("src",t.getImageSrc(o),P),a(2),A(" ",o.name," "),a(3),V(" ",o.level>0?"Level "+o.level:"Cantrip"," ",Y(11,5,o.school,t.schools)," Spell ")}}var Q=(()=>{let e=class e{constructor(){this.spells=B.required(),this.schools=[{initial:"A",name:"Abjuration"},{initial:"C",name:"Conjuration"},{initial:"D",name:"Divination"},{initial:"E",name:"Enchantment"},{initial:"V",name:"Evocation"},{initial:"I",name:"Illusion"},{initial:"N",name:"Necromancy"},{initial:"T",name:"Transmutation"}]}getImageSrc(t){let n="./assets/spells/Spell",i=this.schools.find(d=>d.initial===t.school)?.name,j=t.name.split(" ").map(d=>`${d[0].toUpperCase()}${d.substring(1)}`).join("");return`${n}_${i}_${j}.webp`}};e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=b({type:e,selectors:[["dnd-spells-list"]],inputs:{spells:[1,"spells"]},standalone:!0,features:[y],decls:4,vars:0,consts:[[1,"join","join-vertical","m-1","flex","w-full","bg-gradient-to-r","from-amber-800","via-amber-400","to-amber-800","text-white"],[1,"mx-0.5","rounded-lg"],[1,"collapse","join-item","collapse-arrow","my-0.5","bg-brown-900"],["type","checkbox",3,"name"],[1,"collapse-title"],[1,"flex","flex-col"],[1,"flex","gap-2"],["alt","",1,"w-8",3,"src"],[1,"sm:text:xl","font-alegreya","text-lg","font-extrabold"],[1,"text-md","font-alegreya","font-extrabold","text-brown-200"],[1,"collapse-content"]],template:function(n,i){n&1&&(r(0,"div",0)(1,"div",1),U(2,ee,15,8,"div",2,_),c()()),n&2&&(a(2),G(i.spells()))},dependencies:[K],encapsulation:2});let s=e;return s})();function S(s){s||(L(S),s=l(O));let e=new E(o=>s.onDestroy(o.next.bind(o)));return o=>o.pipe(M(e))}var W=(()=>{let e=class e{constructor(){this.httpClient=l(J)}requestSpellbooks(){return I([{name:"Player's Handbook",id:"PHB",jsonFileName:"spells-phb.json",spells:[],isSelected:!1,isLoaded:!1},{name:"Xenethar's Guide to Everything",id:"XGE",jsonFileName:"spells-xge.json",spells:[],isSelected:!1,isLoaded:!1},{name:"Tasha's Cauldron of Everything",id:"TCE",jsonFileName:"spells-tce.json",spells:[],isSelected:!1,isLoaded:!1},{name:"Fizban's Treasury of Dragons",id:"FTD",jsonFileName:"spells-ftd.json",spells:[],isSelected:!1,isLoaded:!1}])}requestGeneralBooksData(){return this.httpClient.get("https://5e.tools/data/generated/gendata-nav-adventure-book-index.json").pipe(w(t=>(this.handleError(t),k)),F(t=>t.adventure.concat(t.book)))}requestSpellsInBook(t){return this.httpClient.get(`https://5e.tools/data/spells/${t}`).pipe(w(n=>(this.handleError(n),k)))}handleError(t){console.log(t)}};e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=h({token:e,factory:e.\u0275fac,providedIn:"root"});let s=e;return s})();var Z=(()=>{let e=class e{constructor(){this.fiveEtoolsService=l(W),this.state=C({spellbooks:[],spells:[]}),this.spellbooks=g(()=>this.state().spellbooks),this.spells=g(()=>this.state().spellbooks.map(t=>t.spells).flat()),this.spellbooks$=$([this.fiveEtoolsService.requestSpellbooks(),this.fiveEtoolsService.requestGeneralBooksData()]).pipe(q(([t,n])=>(t.forEach(i=>i.name=n.find(j=>j.id==i.id)?.name),D(t)))),this.spells$=this.spellbooks$.pipe(T(t=>this.fiveEtoolsService.requestSpellsInBook(t.jsonFileName))),this.spellbooks$.pipe(S()).subscribe(t=>this.state.update(n=>f(m({},n),{spellbooks:[...n.spellbooks,t]}))),this.spells$.pipe(S(),N(t=>console.log(t))).subscribe(t=>this.state.update(n=>f(m({},n),{spellbooks:n.spellbooks.map(i=>i.id===t.spell[0].source?f(m({},i),{spells:t.spell}):i)})))}};e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=h({token:e,factory:e.\u0275fac,providedIn:"root"});let s=e;return s})();var Me=(()=>{let e=class e{constructor(){this.spellsService=l(Z)}};e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=b({type:e,selectors:[["dnd-spells"]],standalone:!0,features:[y],decls:4,vars:1,consts:[[1,"text-center","text-lg","font-bold","text-brown-500"],[1,"flex","w-full","justify-center"],[1,"container","flex","justify-center",3,"spells"]],template:function(n,i){n&1&&(r(0,"p",0),p(1," Player's Handbook "),c(),r(2,"div",1),u(3,"dnd-spells-list",2),c()),n&2&&(a(3),v("spells",i.spellsService.spells()))},dependencies:[Q],encapsulation:2});let s=e;return s})();export{Me as default};
