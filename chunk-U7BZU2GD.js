import{Aa as T,Ba as B,Ca as L,Da as l,Ea as c,Fa as b,G as F,H as q,Ha as N,Ia as w,Ja as U,K as f,Ka as v,P as o,R as M,S as h,Ta as y,Z as R,a as p,b as u,cb as G,da as O,e as C,ea as $,j as d,k as D,oa as a,p as S,q as I,r as E,ua as j,v as m}from"./chunk-NVJGF3XY.js";var Y=(s,e)=>e.name;function z(s,e){if(s&1&&(l(0,"div",1),b(1,"input",2),l(2,"div",3),w(3),c(),l(4,"div",4)(5,"p"),w(6,"Collapse Content"),c()()()),s&2){let i=e.$implicit;a(),N("name",i.name),a(2),U(" ",i.name," ")}}var H=(()=>{let e=class e{constructor(){this.spells=$.required()}};e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=h({type:e,selectors:[["dnd-spells-list"]],inputs:{spells:[M.SignalBased,"spells"]},standalone:!0,features:[v],decls:3,vars:0,consts:[[1,"join","join-vertical","m-1","w-full","text-white"],[1,"collapse","join-item","collapse-arrow","border-2","border-brown-500"],["type","checkbox",3,"name"],[1,"sm:text:xl","text-md","collapse-title","font-medium"],[1,"collapse-content"]],template:function(n,r){n&1&&(l(0,"div",0),B(1,z,7,2,"div",1,Y),c()),n&2&&(a(),L(r.spells()))},encapsulation:2});let s=e;return s})();function g(s){s||(R(g),s=o(O));let e=new C(i=>s.onDestroy(i.next.bind(i)));return i=>i.pipe(q(e))}var P=(()=>{let e=class e{constructor(){this.httpClient=o(G)}requestSpellbooks(){return this.httpClient.get("https://5e.tools/data/spells/index.json").pipe(m(t=>(this.handleError(t),d)),S(t=>Object.entries(t).map(([r,k])=>({name:"",id:r,jsonFileName:k,spells:[],isSelected:!1,isLoaded:!1}))))}requestGeneralBooksData(){return this.httpClient.get("https://5e.tools/data/generated/gendata-nav-adventure-book-index.json").pipe(m(t=>(this.handleError(t),d)),S(t=>t.adventure.concat(t.book)))}requestSpellsInBook(t){return this.httpClient.get(`https://5e.tools/data/spells/${t}`).pipe(m(n=>(this.handleError(n),d)))}handleError(t){console.log(t)}};e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=f({token:e,factory:e.\u0275fac,providedIn:"root"});let s=e;return s})();var V=(()=>{let e=class e{constructor(){this.fiveEtoolsService=o(P),this.state=j({spellbooks:[],spells:[]}),this.spellbooks=y(()=>this.state().spellbooks),this.spells=y(()=>this.state().spellbooks.map(t=>t.spells).flat()),this.spellbooks$=I([this.fiveEtoolsService.requestSpellbooks(),this.fiveEtoolsService.requestGeneralBooksData()]).pipe(F(([t,n])=>(t.forEach(r=>r.name=n.find(k=>k.id==r.id)?.name),D(t)))),this.spells$=this.spellbooks$.pipe(E(t=>this.fiveEtoolsService.requestSpellsInBook(t.jsonFileName))),this.spellbooks$.pipe(g()).subscribe(t=>this.state.update(n=>u(p({},n),{spellbooks:[...n.spellbooks,t]}))),this.spells$.pipe(g()).subscribe(t=>this.state.update(n=>u(p({},n),{spellbooks:n.spellbooks.map(r=>r.id===t.spell[0].source?u(p({},r),{spells:t.spell}):r)})))}};e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=f({token:e,factory:e.\u0275fac,providedIn:"root"});let s=e;return s})();var je=(()=>{let e=class e{constructor(){this.spellsService=o(V)}};e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=h({type:e,selectors:[["dnd-spells"]],standalone:!0,features:[v],decls:2,vars:1,consts:[[1,"flex","w-full","justify-center"],[1,"container","flex","justify-center",3,"spells"]],template:function(n,r){n&1&&(l(0,"div",0),b(1,"dnd-spells-list",1),c()),n&2&&(a(),T("spells",r.spellsService.spells()))},dependencies:[H],encapsulation:2});let s=e;return s})();export{je as default};
